<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.8.13"/>
    <style>
        /*!
         * IE10 viewport hack for Surface/desktop Windows 8 bug
         * Copyright 2014-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         */
        @-webkit-viewport { width: device-width; }
        @-moz-viewport    { width: device-width; }
        @-ms-viewport     { width: device-width; }
        @-o-viewport      { width: device-width; }
        @viewport         { width: device-width; }
      </style>
  <title>SpECTRE: CoordinateMaps::BulgedCube Class Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "color.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
});
MathJax.Hub.Config({
    tex2jax: {inlineMath: [['^^','^^'], ['\\(', '\\)']]}
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="bootstrap.min.js"></script>
  <script type="text/javascript" src="spectre.js"></script>
  </head>
  <body>
  <div id="top" class="navbar-fixed-top"><!-- do not remove this div, it is closed by doxygen! -->
  <!-- BEGIN TITLEAREA -->
  <div id="titlearea">
  <script type="text/javascript">
  var searchBox = new SearchBox("searchBox", "search",false,'Search');
  </script>
  <div id="main-nav">
    <ul class="sm sm-dox" id="main-menu">
      <li>
      <a href="index.html">
      SpECTRE &#160;
        <span id="projectnumber">v0.0.0</span>
      </a>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-book"></i><span>Documentation</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 135px;">
            <a href="index.html">
            <i class="octicon octicon-book"></i><span>Introduction</span></a>
          </li>
          <li style="min-width: 135px;">
            <a href="installation.html">
              <i class="octicon octicon-desktop-download"></i><span>Installation</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="tutorials.html">
              <i class="octicon octicon-mortar-board"></i><span>User Tutorials</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="dev_guide.html">
              <i class="octicon octicon-gist-secret"></i><span>Dev Guide</span>
            </a>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-code"></i>
              <span>Reference</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 130px;">
            <a href="modules.html">
              <i class="octicon octicon-code"></i>
              <span>Topics</span>
            </a>
          </li>
          <li style="min-width: 130px;">
            <a href="namespaces.html">
              <i class="octicon octicon-gist"></i>
              <span>Namespaces</span>
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="files.html">
          <i class="octicon octicon-file-directory"></i><span>Files</span>
        </a>
      </li>
      <li>
        <a href="https://github.com/sxs-collaboration/spectre" target="_blank">
          <i class="octicon octicon-mark-github"></i><span>View on GitHub</span>
        </a>
      </li>
      <!--The Search <li> is added by doxygen later-->
    </ul>
  </div><!-- main-nav -->
  </div><!-- titlearea -->
  <!-- window showing the filter options -->
  <div id="MSearchSelectWindow"  style="position: fixed;"
       onmouseover="return searchBox.OnSearchSelectShow()"
       onmouseout="return searchBox.OnSearchSelectHide()"
       onkeydown="return searchBox.OnSearchSelectKey(event)">
  </div>
  <!-- iframe showing the search results (closed by default) -->
  <div id="MSearchResultsWindow"  style="position: fixed;">
  <iframe src="javascript:void(0)" frameborder="0"
          name="MSearchResults" id="MSearchResults">
  </iframe>
  </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceCoordinateMaps.html">CoordinateMaps</a></li><li class="navelem"><a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classCoordinateMaps_1_1BulgedCube-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CoordinateMaps::BulgedCube Class Reference<div class="ingroups"><a class="el" href="group__CoordinateMapsGroup.html">Coordinate Maps</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Three dimensional map from the cube to a bulged cube. The cube is shaped such that the surface is compatible with the inner surface of <a class="el" href="classCoordinateMaps_1_1Wedge3D.html" title="Three dimensional map from the cube to a wedge. ">Wedge3D</a>. The shape of the object can be chosen to be cubical, if the sphericity is set to 0, or to a sphere, if the sphericity is set to 1. The sphericity can be set to any number between 0 and 1 for a bulged cube.  
 <a href="classCoordinateMaps_1_1BulgedCube.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="BulgedCube_8hpp_source.html">BulgedCube.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adcee09a0a631bfdde83d0c61e2d0b1e5"><td class="memItemLeft" align="right" valign="top"><a id="adcee09a0a631bfdde83d0c61e2d0b1e5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BulgedCube</b> (double radius, double sphericity, bool use_equiangular_map) noexcept</td></tr>
<tr class="separator:adcee09a0a631bfdde83d0c61e2d0b1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af063cf5c6007319cb8afbfb13e819e79"><td class="memItemLeft" align="right" valign="top"><a id="af063cf5c6007319cb8afbfb13e819e79"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BulgedCube</b> (<a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;&amp;) noexcept=default</td></tr>
<tr class="separator:af063cf5c6007319cb8afbfb13e819e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42590990b9f1be7a60e367b67b197513"><td class="memItemLeft" align="right" valign="top"><a id="a42590990b9f1be7a60e367b67b197513"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>BulgedCube</b> (const <a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;) noexcept=default</td></tr>
<tr class="separator:a42590990b9f1be7a60e367b67b197513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53555a794d7d54d271566c6bfb36b62c"><td class="memItemLeft" align="right" valign="top"><a id="a53555a794d7d54d271566c6bfb36b62c"></a>
<a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;) noexcept=default</td></tr>
<tr class="separator:a53555a794d7d54d271566c6bfb36b62c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1edbb51c80ad3d0ad0f00c7f7a616cf9"><td class="memItemLeft" align="right" valign="top"><a id="a1edbb51c80ad3d0ad0f00c7f7a616cf9"></a>
<a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;&amp;) noexcept=default</td></tr>
<tr class="separator:a1edbb51c80ad3d0ad0f00c7f7a616cf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6e30367c090a193791755fb29ea8962"><td class="memTemplParams" colspan="2"><a id="aa6e30367c090a193791755fb29ea8962"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:aa6e30367c090a193791755fb29ea8962"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3 &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>operator()</b> (const <a class="elRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords) const noexcept</td></tr>
<tr class="separator:aa6e30367c090a193791755fb29ea8962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6389bc1681ffdd107f0b22e72511067d"><td class="memTemplParams" colspan="2"><a id="a6389bc1681ffdd107f0b22e72511067d"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a6389bc1681ffdd107f0b22e72511067d"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3 &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>inverse</b> (const <a class="elRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;target_coords) const noexcept</td></tr>
<tr class="separator:a6389bc1681ffdd107f0b22e72511067d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3265ab0b6b1ea613cb27a0ea5e599004"><td class="memTemplParams" colspan="2"><a id="a3265ab0b6b1ea613cb27a0ea5e599004"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a3265ab0b6b1ea613cb27a0ea5e599004"><td class="memTemplItemLeft" align="right" valign="top">tnsr::Ij&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3, <a class="el" href="structFrame_1_1NoFrame.html">Frame::NoFrame</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>jacobian</b> (const <a class="elRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords) const noexcept</td></tr>
<tr class="separator:a3265ab0b6b1ea613cb27a0ea5e599004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f86abb61a30db1e5bc5e8fb6666481"><td class="memTemplParams" colspan="2"><a id="aa4f86abb61a30db1e5bc5e8fb6666481"></a>
template&lt;typename T &gt; </td></tr>
<tr class="memitem:aa4f86abb61a30db1e5bc5e8fb6666481"><td class="memTemplItemLeft" align="right" valign="top">tnsr::Ij&lt; tt::remove_cvref_wrap_t&lt; T &gt;, 3, <a class="el" href="structFrame_1_1NoFrame.html">Frame::NoFrame</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><b>inv_jacobian</b> (const <a class="elRef" doxygen="/work/spectre/docs/config/cppreference-doxygen-web.tag.xml:http://en.cppreference.com/w/" href="http://en.cppreference.com/w/cpp/container/array.html">std::array</a>&lt; T, 3 &gt; &amp;source_coords) const noexcept</td></tr>
<tr class="separator:aa4f86abb61a30db1e5bc5e8fb6666481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8888ee6b8366157ed01d2dd5eeb02211"><td class="memItemLeft" align="right" valign="top"><a id="a8888ee6b8366157ed01d2dd5eeb02211"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pup</b> (PUP::er &amp;p) noexcept</td></tr>
<tr class="separator:a8888ee6b8366157ed01d2dd5eeb02211"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a530dcb556f3b68178c99723212abd778"><td class="memItemLeft" align="right" valign="top"><a id="a530dcb556f3b68178c99723212abd778"></a>
static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><b>dim</b> = 3</td></tr>
<tr class="separator:a530dcb556f3b68178c99723212abd778"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a2d2eac1172958f73026ee367a5919c88"><td class="memItemLeft" align="right" valign="top"><a id="a2d2eac1172958f73026ee367a5919c88"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>operator==</b> (const <a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;lhs, const <a class="el" href="classCoordinateMaps_1_1BulgedCube.html">BulgedCube</a> &amp;rhs) noexcept</td></tr>
<tr class="separator:a2d2eac1172958f73026ee367a5919c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Three dimensional map from the cube to a bulged cube. The cube is shaped such that the surface is compatible with the inner surface of <a class="el" href="classCoordinateMaps_1_1Wedge3D.html" title="Three dimensional map from the cube to a wedge. ">Wedge3D</a>. The shape of the object can be chosen to be cubical, if the sphericity is set to 0, or to a sphere, if the sphericity is set to 1. The sphericity can be set to any number between 0 and 1 for a bulged cube. </p>
<h3>Details</h3>
<p>The volume map from the cube to a bulged cube is obtained by interpolating between six surface maps, twelve bounding curves, and eight corners. The surface map for the upper +z axis is obtained by interpolating between a cubical surface and a spherical surface. The two surfaces are chosen such that the latter circumscribes the former.</p>
<p>We make a choice here as to whether we wish to use the logical coordinates parameterizing these surface as they are, in which case we have the equidistant choice of coordinates, or whether to apply a tangent map to them which leads us to the equiangular choice of coordinates. In terms of the logical coordinates, the equiangular coordinates are:</p>
<p class="formulaDsp">
\[\textrm{equiangular xi} : \Xi(\xi) = \textrm{tan}(\xi\pi/4)\]
</p>
<p class="formulaDsp">
\[\textrm{equiangular eta} : \mathrm{H}(\eta) = \textrm{tan}(\eta\pi/4)\]
</p>
<p>With derivatives:</p>
<p class="formulaDsp">
\[\Xi&#39;(\xi) = \frac{\pi}{4}(1+\Xi^2)\]
</p>
<p class="formulaDsp">
\[\mathrm{H}&#39;(\eta) = \frac{\pi}{4}(1+\mathrm{H}^2)\]
</p>
<p>The equidistant coordinates are:</p>
<p class="formulaDsp">
\[ \textrm{equidistant xi} : \Xi = \xi\]
</p>
<p class="formulaDsp">
\[ \textrm{equidistant eta} : \mathrm{H} = \eta\]
</p>
<p>with derivatives:</p>
<center> \(\Xi&#39;(\xi) = 1\), and \(\mathrm{H}&#39;(\eta) = 1\)</center><p>We also define the variable \(\rho\), given by:</p>
<p class="formulaDsp">
\[\rho = \sqrt{1+\Xi^2+\mathrm{H}^2}\]
</p>
<h3>The Spherical Face Map</h3>
<p>The surface map for the spherical face of radius \(R\) lying in the \(+z\) direction in either choice of coordinates is then given by:</p>
<p class="formulaDsp">
\[\vec{\sigma}_{spherical}: \vec{\xi} \rightarrow \vec{x}(\vec{\xi})\]
</p>
<p> Where </p><p class="formulaDsp">
\[ \vec{x}(\xi,\eta) = \begin{bmatrix} x(\xi,\eta)\\ y(\xi,\eta)\\ z(\xi,\eta)\\ \end{bmatrix} = \frac{R}{\rho} \begin{bmatrix} \Xi\\ \mathrm{H}\\ 1\\ \end{bmatrix} \]
</p>
<h3>The Cubical Face Map</h3>
<p>The surface map for the cubical face of side length \(2L\) lying in the \(+z\) direction is given by:</p>
<p class="formulaDsp">
\[\vec{\sigma}_{cubical}: \vec{\xi} \rightarrow \vec{x}(\vec{\xi})\]
</p>
<p> Where </p><p class="formulaDsp">
\[ \vec{x}(\xi,\eta) = \begin{bmatrix} x(\xi,\eta)\\ y(\xi,\eta)\\ L\\ \end{bmatrix} = L \begin{bmatrix} \Xi\\ \mathrm{H}\\ 1\\ \end{bmatrix} \]
</p>
<h3>The Bulged Face Map</h3>
<p>To construct the bulged map we interpolate between this cubical face map and a spherical face map of radius <code>radius_of_other_surface</code>, with the interpolation parameter being \(s\), the <code>sphericity</code>. The surface map for the bulged face lying in the \(+z\) direction is then given by:</p>
<p class="formulaDsp">
\[ \vec{\sigma}_{+z}(\xi,\eta) = \left\{(1-s)L + \frac{sR}{\rho}\right\} \begin{bmatrix} \Xi\\ \mathrm{H}\\ 1\\ \end{bmatrix} \]
</p>
<p>We constrain L by demanding that the spherical face circumscribe the cube. With this condition, we have \(L = R/\sqrt3\).</p>
<h3>The General Formula for 3D Isoparametric Maps</h3>
<p>The general formula is given by Eq. 1 in section 2.1 of Hesthaven's paper "A Stable Penalty Method For The Compressible Navier-Stokes Equations III.
 Multidimensional Domain Decomposition Schemes" available <a href="
 http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.699.1161&amp;rep=rep1&amp;type=pdf
 ">here </a>.</p>
<p>Hesthaven's formula is general in the degree of the shape functions used, so for our purposes we take the special case where the shape functions are linear, and define new variables accordingly.</p>
<p>We define the following variables for \(\alpha, \beta, \gamma \in\{\xi,\eta,\zeta\}\):</p>
<p class="formulaDsp">
\[ f^{\pm}_{\alpha} = \frac{1}{2}(1\pm\alpha)\\ f^{\pm\pm}_{\alpha \ \beta} = \frac{1}{4}(1\pm\alpha)(1\pm\beta)\\ f^{\pm\pm\pm}_{\alpha \ \beta \ \gamma} = \frac{1}{8}(1\pm\alpha)(1\pm\beta)(1\pm\gamma) \]
</p>
<p>The formula involves six surfaces, which we will denote by \(\vec{\sigma}\), twelve curves, denoted by \(\vec{\Gamma}\), and eight vertices, denoted by \(\vec{\pi}\), with the subscripts denoting which face(s) these objects belong to. The full volume map is given by:</p>
<p class="formulaDsp">
\begin{align*} \phi(\xi,\eta,\zeta) = &amp; f^{+}_{\zeta}\vec{\sigma}_{+\zeta}(\xi, \eta)+ f^{-}_{\zeta}\vec{\sigma}_{-\zeta}(\xi, \eta)\\ &amp;+ f^{+}_{\eta}\vec{\sigma}_{+\eta}(\xi, \zeta)+ f^{-}_{\eta}\vec{\sigma}_{-\eta}(\xi, \zeta)+ f^{+}_{\xi}\vec{\sigma}_{+\xi}(\eta, \zeta)+ f^{-}_{\xi}\vec{\sigma}_{-\xi}(\eta, \zeta)\\ &amp;- f^{++}_{\xi \ \eta}\vec{\Gamma}_{+\xi +\eta}(\zeta)- f^{-+}_{\xi \ \eta}\vec{\Gamma}_{-\xi +\eta}(\zeta)- f^{+-}_{\xi \ \eta}\vec{\Gamma}_{+\xi -\eta}(\zeta)- f^{--}_{\xi \ \eta}\vec{\Gamma}_{-\xi -\eta}(\zeta)\\ &amp;- f^{++}_{\xi \ \zeta}\vec{\Gamma}_{+\xi +\zeta}(\eta)- f^{-+}_{\xi \ \zeta}\vec{\Gamma}_{-\xi +\zeta}(\eta)- f^{+-}_{\xi \ \zeta}\vec{\Gamma}_{+\xi -\zeta}(\eta)- f^{--}_{\xi \ \zeta}\vec{\Gamma}_{-\xi -\zeta}(\eta)\\ &amp;- f^{++}_{\eta \ \zeta}\vec{\Gamma}_{+\eta +\zeta}(\xi)- f^{-+}_{\eta \ \zeta}\vec{\Gamma}_{-\eta +\zeta}(\xi)- f^{+-}_{\eta \ \zeta}\vec{\Gamma}_{+\eta -\zeta}(\xi)- f^{--}_{\eta \zeta}\vec{\Gamma}_{-\eta -\zeta}(\xi)\\ &amp;+ f^{+++}_{\xi \ \eta \ \zeta}\vec{\pi}_{+\xi +\eta +\zeta}+ f^{-++}_{\xi \ \eta \ \zeta}\vec{\pi}_{-\xi +\eta +\zeta}+ f^{+-+}_{\xi \ \eta \ \zeta}\vec{\pi}_{+\xi -\eta +\zeta}+ f^{--+}_{\xi \ \eta \ \zeta}\vec{\pi}_{-\xi -\eta +\zeta}\\ &amp;+ f^{++-}_{\xi \ \eta \ \zeta}\vec{\pi}_{+\xi +\eta -\zeta}+ f^{-+-}_{\xi \ \eta \ \zeta}\vec{\pi}_{-\xi +\eta -\zeta}+ f^{+--}_{\xi \ \eta \ \zeta}\vec{\pi}_{+\xi -\eta -\zeta}+ f^{---}_{\xi \ \eta \ \zeta}\vec{\pi}_{-\xi -\eta -\zeta} \end{align*}
</p>
<h3>The Special Case for Octahedral Symmetry</h3>
<p>The general formula is for the case in which there are six independently specified bounding surfaces. In our case, the surfaces are obtained by rotations and reflections of the upper- \(\zeta\) face.</p>
<p>We define the matrices corresponding to these transformations to be:</p>
<p class="formulaDsp">
\[ S_{xy} = \begin{bmatrix} 0 &amp; 1 &amp; 0\\ 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1\\ \end{bmatrix},\ S_{xz} = \begin{bmatrix} 0 &amp; 0 &amp; 1\\ 0 &amp; 1 &amp; 0\\ 1 &amp; 0 &amp; 0\\ \end{bmatrix},\ S_{yz} = \begin{bmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1\\ 0 &amp; 1 &amp; 0\\ \end{bmatrix}\]
</p>
<p class="formulaDsp">
\[C_{zxy} = \begin{bmatrix} 0 &amp; 0 &amp; 1\\ 1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ \end{bmatrix},\ C_{yzx} = \begin{bmatrix} 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 1\\ 1 &amp; 0 &amp; 0\\ \end{bmatrix}\]
</p>
<p class="formulaDsp">
\[N_{x} = \begin{bmatrix} -1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 1\\ \end{bmatrix},\ N_{y} = \begin{bmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; -1 &amp; 0\\ 0 &amp; 0 &amp; 1\\ \end{bmatrix},\ N_{z} = \begin{bmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; -1\\ \end{bmatrix} \]
</p>
<p>The surface maps can now all be written in terms of \(\vec{\sigma}_{+\zeta}\) and these matrices: </p><center> \(\vec{\sigma}_{-\zeta}(\xi, \eta) = N_z\vec{\sigma}_{+\zeta}(\xi, \eta)\\ \vec{\sigma}_{+\eta}(\xi, \zeta) = S_{yz}\vec{\sigma}_{+\zeta}(\xi, \zeta)\\ \vec{\sigma}_{-\eta}(\xi, \zeta) = N_yS_{yz}\vec{\sigma}_{+\zeta}(\xi, \zeta)\\ \vec{\sigma}_{+\xi}(\eta, \zeta) = C_{zxy}\vec{\sigma}_{+\zeta}(\eta, \zeta)\\ \vec{\sigma}_{-\xi}(\eta, \zeta) = N_xC_{zyx}\vec{\sigma}_{+\zeta}(\eta, \zeta)\) </center><p>The four bounding curves \(\vec{\Gamma}\) on the \(+\zeta\) face are given by:</p>
<center> \(\vec{\Gamma}_{+\xi,+\zeta}(\eta) = \vec{\sigma}_{+\zeta}(+1,\eta)\\ \vec{\Gamma}_{-\xi,+\zeta}(\eta) = \vec{\sigma}_{+\zeta}(-1,\eta) = N_x\vec{\sigma}_{+\zeta}(+1, \eta)\\ \vec{\Gamma}_{+\eta,+\zeta}(\xi) = \vec{\sigma}_{+\zeta}(\xi,+1) = S_{xy}\vec{\sigma}_{+\zeta}(+1, \xi)\\ \vec{\Gamma}_{-\eta,+\zeta}(\xi) = \vec{\sigma}_{+\zeta}(\xi,-1) = N_yS_{xy}\vec{\sigma}_{+\zeta}(+1,\xi)\) </center><p>The bounding curves on the other surfaces can be obtained by transformations on the \(+\zeta\) face:</p>
<center> \(\vec{\Gamma}_{+\xi,-\zeta}(\eta) = N_z\vec{\sigma}_{+\zeta}(+1,\eta)\\ \vec{\Gamma}_{-\xi,-\zeta}(\eta) = N_z\vec{\sigma}_{+\zeta}(-1,\eta) = N_zN_x\vec{\sigma}_{+\zeta}(+1,\eta)\\ \vec{\Gamma}_{+\eta,-\zeta}(\xi) = N_z\vec{\sigma}_{+\zeta}(\xi,+1) = N_zS_{xy}\vec{\sigma}_{+\zeta}(+1, \xi)\\ \vec{\Gamma}_{-\eta,-\zeta}(\xi) = N_z\vec{\sigma}_{+\zeta}(\xi,-1) = N_zN_yS_{xy}\vec{\sigma}_{+\zeta}(+1, \xi)\\ \vec{\Gamma}_{+\xi,+\eta}(\zeta) = C_{zxy}\vec{\sigma}_{+\zeta}(+1,\zeta)\\ \vec{\Gamma}_{-\xi,+\eta}(\zeta) = N_xC_{zxy}\vec{\sigma}_{+\zeta}(+1,\zeta)\\ \vec{\Gamma}_{+\xi,-\eta}(\zeta) = C_{zxy}\vec{\sigma}_{+\zeta}(-1,\zeta) = C_{zxy}N_x\vec{\sigma}_{+\zeta}(+1,\zeta)\\ \vec{\Gamma}_{-\xi,-\eta}(\zeta) = N_xC_{zxy}\vec{\sigma}_{+\zeta}(-1,\zeta) = N_xC_{zxy}N_x\vec{\sigma}_{+\zeta}(+1,\zeta)\) </center><p>Now we can write the volume map \(\phi\) in terms of \(\vec{\sigma}_{+\zeta}\) only: </p><p class="formulaDsp">
\begin{align*}\phi(\xi,\eta,\zeta) = &amp; (f^{+}_{\zeta} + f^{-}_{\zeta}N_z) \vec{\sigma}_{+\zeta}(\xi, \eta)\\ &amp;+ (f^{+}_{\eta} + f^{-}_{\eta}N_y) S_{yz}\vec{\sigma}_{+\zeta}(\xi, \zeta)\\ &amp;+ (f^{+}_{\xi} + f^{-}_{\xi}N_x) C_{zxy}\vec{\sigma}_{+\zeta}(\eta, \zeta)\\ &amp;- (f^{+}_{\xi}+f^{-}_{\xi}N_x) (f^{+}_{\eta}+f^{-}_{\eta}N_y) C_{zxy}\vec{\sigma}_{+\zeta}(+1, \zeta)\\ &amp;- (f^{+}_{\zeta}+f^{-}_{\zeta}N_z)\left\{ (f^{+}_{\xi}+f^{-}_{\xi}N_x)\vec{\sigma}_{+\zeta}(+1, \eta)+ (f^{+}_{\eta}+f^{-}_{\eta}N_y)S_{xy}\vec{\sigma}_{+\zeta}(+1, \xi)\right\}\\ &amp;+ \frac{r}{\sqrt{3}}\vec{\xi} \end{align*}
</p>
<p>Note that we can now absorb all of the \(f\)s into the matrix prefactors in the above equation and obtain a final set of matrices. We define the following <em>blending matrices</em>:</p>
<p class="formulaDsp">
\[ B_{\xi} = \begin{bmatrix} 0 &amp; 0 &amp; \xi\\ 1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ \end{bmatrix},\ B_{\eta} = \begin{bmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; \eta\\ 0 &amp; 1 &amp; 0\\ \end{bmatrix},\ B_{\zeta} = \begin{bmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; \zeta\\ \end{bmatrix}\\ B_{\xi\eta} = \begin{bmatrix} 0 &amp; 0 &amp; \xi\\ \eta &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ \end{bmatrix},\ B_{\xi\zeta} = \begin{bmatrix} \xi &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; \zeta\\ \end{bmatrix},\ B_{\eta\zeta} = \begin{bmatrix} 0 &amp; 1 &amp; 0\\ \eta &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; \zeta\\ \end{bmatrix}\\ B_{\xi\eta\zeta} = \begin{bmatrix} \xi &amp; 0 &amp; 0\\ 0 &amp; \eta &amp; 0\\ 0 &amp; 0 &amp; \zeta\\ \end{bmatrix} \]
</p>
<p>Now we can write the volume map \(\phi\) in these terms:</p>
<p class="formulaDsp">
\begin{align*} \phi(\xi,\eta,\zeta) = &amp; B_{\zeta} \vec{\sigma}_{+\zeta}(\xi, \eta)\\&amp; + B_{\eta} \vec{\sigma}_{+\zeta}(\xi, \zeta)+ B_{\xi} \vec{\sigma}_{+\zeta}(\eta, \zeta)\\&amp; - B_{\xi \eta} \vec{\sigma}_{+\zeta}(+1, \zeta)- B_{\xi \zeta} \vec{\sigma}_{+\zeta}(+1, \eta)+ B_{\eta \zeta} \vec{\sigma}_{+\zeta}(+1, \xi)\\&amp; + B_{\xi \eta \zeta} \vec{\sigma}_{+\zeta}(+1, +1) \end{align*}
</p>
<h3>The Bulged Cube Map</h3>
<p>We now use the result above to provide the mapping for the bulged cube. First we will define the variables \(\rho_A\) and \(\rho_{AB}\), for \(A, B \in \{\Xi,\mathrm{H}, \mathrm{Z}\} \): </p><p class="formulaDsp">
\[ \rho_A = \sqrt{2 + A^2}\\ \rho_{AB} = \sqrt{1 + A^2 + B^2} \]
</p>
<p> The final mapping is then: </p><p class="formulaDsp">
\[ \vec{x}(\xi,\eta,\zeta) = \frac{(1-s)r}{\sqrt{3}} \begin{bmatrix} \Xi\\ \mathrm{H}\\ \mathrm{Z}\\ \end{bmatrix} + \frac{sr}{\sqrt{3}} \begin{bmatrix} \xi\\ \eta\\ \zeta\\ \end{bmatrix} + sr \begin{bmatrix} \xi &amp; \Xi &amp; \Xi\\ \mathrm{H} &amp; \eta &amp;\mathrm{H}\\ \mathrm{Z} &amp; \mathrm{Z} &amp; \zeta\\ \end{bmatrix} \begin{bmatrix} 1/\rho_{\mathrm{H}\mathrm{Z}}\\ 1/\rho_{\Xi\mathrm{Z}}\\ 1/\rho_{\Xi\mathrm{H}}\\ \end{bmatrix} - sr \begin{bmatrix} \Xi &amp; \xi &amp; \xi\\ \eta &amp; \mathrm{H} &amp;\eta\\ \zeta &amp; \zeta &amp; \mathrm{Z}\\ \end{bmatrix} \begin{bmatrix} 1/\rho_{\Xi}\\ 1/\rho_{\mathrm{H}}\\ 1/\rho_{\mathrm{Z}}\\ \end{bmatrix} \]
</p>
<p>In the case where the same coordinates are used for the cube and the sphere, we have \(\xi = \Xi\), etc. In this case, the formula reduces further. It is given by:</p>
<p class="formulaDsp">
\[ \vec{x}(\xi,\eta,\zeta) = \left\{ \frac{r}{\sqrt{3}} + sr \left( 1/\rho_{\mathrm{H}\mathrm{Z}}+ 1/\rho_{\Xi\mathrm{Z}}+ 1/\rho_{\Xi\mathrm{H}}- 1/\rho_{\Xi}- 1/\rho_{\mathrm{H}}- 1/\rho_{\mathrm{Z}} \right) \right\} \begin{bmatrix} \Xi\\ \mathrm{H}\\ \mathrm{Z}\\ \end{bmatrix} \]
</p>
 </div><hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Domain/CoordinateMaps/<a class="el" href="BulgedCube_8hpp_source.html">BulgedCube.hpp</a></li>
<li>src/Domain/CoordinateMaps/BulgedCube.cpp</li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2017 - 2018
<a href="https://black-holes.org">SXS Collaboration</a>,
<a href="LICENSE.txt" target="_blank">
<span class="hidden-xs">Distributed under the</span>
MIT License</a>
</small></address>
</body>
</html>
